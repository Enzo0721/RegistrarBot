# docker-compose.yml

# Use version 3.8 of the Docker Compose file format.
version: "3.8"

# Define the services (containers) that your project needs.
services:
  # We'll define our PostgreSQL database service and name it 'db'.
  db:
    # Use the official PostgreSQL version 15 image. 'alpine' is a lightweight version.
    image: postgres:15-alpine

    # This ensures the database container restarts automatically if it ever stops.
    restart: always

    # === CONFIGURATION ===
    # Set the environment variables for the database.
    # We will use these exact values to connect from Prisma.
    environment:
      - POSTGRES_USER=myuser
      - POSTGRES_PASSWORD=mypassword
      - POSTGRES_DB=registrarbot_db

    # === NETWORKING ===
    # Map port 5432 on your computer to port 5432 inside the container.
    # This allows you to connect to the database using 'localhost:5432'.
    ports:
      - "5432:5432"

    # === DATA PERSISTENCE ===
    # This is VERY important. It saves your database data to a 'volume' on your
    # machine, so you don't lose all your data when you stop the container.
    volumes:
      - postgres_data:/var/lib/postgresql/data

# This officially declares the volume we used above.
volumes:
  postgres_data: